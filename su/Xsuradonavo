#! /bin/sh
#  Radon transform independent of AVO 
# suradoneom uses data weights to take care of AVO
# Tests using simple hyperbolas with AVO  
# April 11 -2002
# Daniel Trad - UBC
# data generated by 
# susynth2 vel=2000,2200  tau=0.8,0.8 nh=65 dh=50 | sunormalize norm=max > hyperbolas.su

set -x

METHOD="$1"

PLOTC="suxwigb key=cdp wbox=550 hbox=650"
PLOTR="suxwigb key=f2 wbox=550 hbox=650"
PLOTT="suxwigb wbox=550 hbox=650"
PLOTX="suxwigb key=offset wbox=550 hbox=650 perc=99"


NAME=hyperbolas3
FILE=$NAME'.su'
FILEOUT="${NAME}.${METHOD}.su"
dxcdp=10
ntrmax=100000000   # For fast tests use only few traces.
t0=0;
VERBOSE=1

CDPMIN=1
CDPMAX=1
PAR=stkvel.cte

if [ $METHOD = "TD" ]; then

mute=1
parmute=-6.5e-7 
qmin=-1e-8
t0=0
smute=2

centralq=25
#example single hyperbola use: nw=21 eps2=5e-1 eps1=5e-1  itercg=30 iter_end=6
suradonavo < $FILE  cdpmin=$CDPMIN cdpmax=$CDPMAX dxcdp=$dxcdp par=$PAR  itercg=30 iter_end=1 eps2=9e-1 eps1=9e-1 nq=110 verbose=0 ntrmax=$ntrmax norm=0 t0=$t0 smute=$smute mute=$mute  parmute=$parmute qmin=$qmin plot=2 pervmin=0.5e-8 dperv=0 centralq=$centralq LI=1 nw=21 typewav=2 fpeak=25 filtout=0  dataprec=$2 outputmodel=1 testadj=0 > $FILEOUT

elif [ $METHOD = "FQ" ]; then

suradonfreq < $FILE  cdpmin=$CDPMIN cdpmax=$CDPMAX dxcdp=$dxcdp nhcdp=$nhcdp par=$PAR itercg=30 iter_end=3 eps2=1e-1 eps1=1e-1 nq=110 verbose=$VERBOSE ntrmax=$ntrmax tmpdir='./' norm=0 buffer=$buffer t0=$t0 smute=$smute mute=$mute  parmute=$parmute qmin=-0.5e-7 factor=0.8 fmax=80 solver="$2" t0mute=$t0mute > $FILEOUT

$PLOTR < model.su
$PLOTX < $FILEOUT

else
    exit 0
fi


Xsetntr $FILEOUT



 




































































































